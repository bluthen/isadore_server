\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{IsadoreReportHybridTab}[2015/04/03 1.1 (Exoteric Analytics)]

\LoadClass[12pt]{article}
\RequirePackage[dvips,letterpaper,left=0.5in,top=1in,bottom=1in]{geometry}
\RequirePackage{longtable}
\RequirePackage{fancyhdr}

%% START HEADER STUFF
\pagestyle{fancy}

\newcommand*{\rptTitle}[1]{\renewcommand*{\IsRpt@rptTitle}{#1}}
\newcommand*{\IsRpt@rptTitle}{Temporary Title}

\lhead{\IsRpt@rptTitle}
\chead{}
\rhead{Generated \today}
\lfoot{Report generated by the Isadore Dryer Monitoring System \copyright~\the\year~Exoteric Analytics, LLP}
\cfoot{}
\rfoot{}

%% END HEADER STUFF

\setlength{\parindent}{0em}

%%%%%%%%%%%%%%%%%%%% 
%% environment for table containing all fills for a given hybrid
%%%%%%%%%%%%%%%%%%%% 
\newcommand*{\tableheading}{Fill & Bin & Field & \parbox[b]{1.25cm}{Shelled MC} & \parbox[b]{1.25cm}{Harvest MC} & \parbox[b]{1.25cm}{Rmvd MC} & \multicolumn{2}{|c|}{Up air} & \multicolumn{2}{|c|}{Down air} & Total air & hrs/pt & Bu \\ \hline & & & & & & \multicolumn{1}{|c|}{hrs} & \multicolumn{1}{|c|}{\%} & \multicolumn{1}{|c|}{hrs} & \multicolumn{1}{|c|}{\%} & & &  \\ \hline \hline}

\newenvironment{hybridTable}[1]
               {\begin{longtable}{|l|l|l|r|r|r|r|r|r|r|r|r|r|}\hline
                   %% table heading row for first page
                   \multicolumn{13}{|l|}{\bf \huge{Hybrid: #1}}\\ \hline
                   \tableheading
                   \endfirsthead
                   %% table heading for subsequent pages
                   \multicolumn{13}{|l|}{hybrid: #1 -- continued from last page} \\ \hline
                   \tableheading
                   \endhead
                   %% setup continuation note row
                   \multicolumn{13}{l}{Continued on next page --} \\ \hline \hline
                   \endfoot
                   %% finish table with a horizontal line
                   \hline
                   \endlastfoot
               }
               {\end{longtable}} %end of environment

\newcommand*{\hybridTableRowOne}[9]{#1 & #2 & \parbox[t]{2cm}{\sloppy \small #3} & #4 & #5 & #6 & #7 & #8 & #9 &}
\newcommand*{\hybridTableRowTwo}[4]{#1 & #2 & #3 & #4}
\newcommand*{\hybridTableNextRow}{\\ \hline}
\newcommand*{\hybridTableAvgRowOne}[9]{\multicolumn{3}{|l|}{Hybrid averages} & #1 & #2 & #3 & #4 & #5 & #6 & #7 & #8 & #9 &}
\newcommand*{\hybridTableAvgRowTwo}[1]{#1}
\newcommand*{\hybridTableTotalRow}[4]{\multicolumn{3}{|l|}{Hybrid totals} & & & & #1 & & #2 & & #3 & & #4}
