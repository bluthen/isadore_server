\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{IsadoreReport}[2012/08/31 1.1 (Exoteric Analytics)]

\LoadClass[11pt]{article}
\RequirePackage[dvips,letterpaper,landscape,left=0.5in,top=1in,bottom=1in]{geometry}
\RequirePackage{longtable}
\RequirePackage{fancyhdr}
%% \RequirePackage{multirow}
\RequirePackage{graphicx}

%% START HEADER STUFF
\pagestyle{fancy}

\newcommand*{\rptTitle}[1]{\renewcommand*{\IsRpt@rptTitle}{#1}}
\newcommand*{\IsRpt@rptTitle}{Temporary Title}

\lhead{\IsRpt@rptTitle}
\chead{}
\rhead{Generated \today}
\lfoot{Report generated by the Isadore Dryer Monitoring System \copyright~\the\year~Exoteric Analytics, LLP}
\cfoot{}
\rfoot{\thepage}

%% END HEADER STUFF

\setlength{\parindent}{0em}

\newcommand*{\dryerMgmtStart}[7]{
  \begin{center}
    \begin{longtable}{|r|c|c|l|c|r|r|rc|rr|r|c|c|}
      %% setup dateline for top of table's first page
      \multicolumn{14}{l}{\bf \huge{#1}}\\ \hline
      Fill&Bin& Field & Hybrid & \parbox[b]{1cm}{Load MC} & \parbox[b]{1cm}{Bin Depth} & SRBu & \multicolumn{2}{|c|}{Air Hours} & \multicolumn{2}{|c|}{Air Times} & Shell Date & \parbox[b]{1cm}{Shell MC} & \parbox[b]{1cm}{Drying Rate} \\ \hline
      & & & & #2 & #3 & #4 & & #5 & & & & #6 & #7 \\ \hline \hline
      \endfirsthead

      %% setup dateline for top of subsequent pages
      \multicolumn{14}{l}{#1 -- continued from previous page.} \\ \hline
      Fill&Bin& Field & Hybrid & \parbox[b]{1cm}{Load MC} & \parbox[b]{1cm}{Bin Depth} & SRBu & \multicolumn{2}{|c|}{Air Hours} & \multicolumn{2}{|c|}{Air Times} & Shell Date & \parbox[b]{1cm}{Shell MC} & \parbox[b]{1cm}{Drying Rate} \\ \hline \hline
      \endhead

      %% setup continuation note row
      \multicolumn{14}{l}{Continued on next page.} \\ \hline \hline
      \endfoot
      
      %% finish table with a couple of horizontal lines
      \hline
      \endlastfoot
}

\newcommand*{\dryerMgmtEnd}{
    \end{longtable}
  \end{center}
  \pagebreak[3]
}

%% todo: use keyval package to replace this dumness
\newcommand*{\dryerMgmtFillLineOneA}[9]{ #1 & #2 & #3 & \parbox[t]{2cm}{\sloppy \small #4} & #5 & #6 & #7 & Up & #8 & Start & #9 & }

\newcommand*{\dryerMgmtFillLineOneB}[3]{
  #1 & #2 & #3 \\*
}

\newcommand*{\dryerMgmtFillLineTwo}[2]{
  & & & & & & & Dn & #1 & Rev & #2 & & & \\* %prevent pagebreak on this newline
}

\newcommand*{\dryerMgmtFillLineThree}[2]{
  & & & & & & & Tot & #1 & Stop & #2 & & &\\ \hline %pagebreak on this newline is OK
}

\newcommand*{\dryerMgmtFillLineMC}[2]{
  #1 & #2 & \\
}

\newcommand*{\dryerMgmtFillLineMConly}[2]{
  & & & & & & & & & & & #1 & #2 & & & \\
}

\newcommand*{\dryerMgmtFillEnd}{\hline}


\newcommand*{\sortMgmtStart}[8]{
  \begin{center}
    \begin{longtable}{|r|c|c|c|c|c|c|c|c|l|l|l|l|l|}
      %% setup dateline for top of table's first page
      \multicolumn{14}{l}{\bf \huge{#1}}\\ \hline
      Fill&Bin& Start & Finish & Gross & Deduct & Net & Start Air & Delay & Field & Hybrid & SRBu & Bu/hr & Depth \\ \hline
      & & & & #2 & #3 & #4 & & #5 & & & #6 & #7 & #8 \\ \hline \hline
      \endfirsthead

      %% setup dateline for top of subsequent pages
      \multicolumn{14}{l}{#1 -- continued from previous page.} \\ \hline
      Fill&Bin& Start & Finish & Gross & Deduct & Net & Start Air & Delay & Field & Hybrid & SRBu & Bu/hr & Depth \\ \hline \hline
      \endhead

      %% setup continuation note row
      \multicolumn{14}{l}{Continued on next page.} \\ \hline \hline
      \endfoot
      
      %% finish table with a couple of horizontal lines
      \hline
      \endlastfoot
}

\newcommand*{\sortMgmtFillLineA}[9]{ #1 & #2 & #3 & #4 & #5 & #6 & #7 & #8 & #9 & }
\newcommand*{\sortMgmtFillLineB}[5]{ #1 & \parbox[t]{3.5cm}{\small #2} & #3 & #4 & #5}

\newcommand*{\sortMgmtEnd}{
    \end{longtable}
  \end{center}
  \pagebreak[3]                 %just a suggestion...
}

\newcommand*{\shellMgmtStart}[7]{
  \begin{center}
    \begin{longtable}{|r|c|c|c|c|c|c|c|c|l|l|l|l|l|l|l|}
      \multicolumn{16}{l}{\bf \huge{#1}}\\ \hline
      %% setup dateline for top of table's first page
      Fill&Bin& Start & End & Gross & Deduct & Net & Field & Hybrid & SRBu & Bu/hr & \parbox[b]{1cm}{Dump Start} & \parbox[b]{1cm}{Dump End} & \parbox[b]{1cm}{Dump Cnt} & \parbox[b]{1cm}{MC} & Dest \\ \hline
      & & & &  #2 & #3 & #4 & & & #5 & #6 & & & & #7 & \\ \hline \hline
      \endfirsthead

      %% setup dateline for top of subsequent pages
      \multicolumn{16}{l}{#1 -- continued from previous page.} \\ \hline
      Fill&Bin& Start & End & Gross & Deduct & Net & Field & Hybrid & SRBu & Bu/hr & \parbox[b]{1cm}{Dump Start} & \parbox[b]{1cm}{Dump End} & \parbox[b]{1cm}{Dump Cnt} & \parbox[b]{1cm}{MC} & Dest\\ \hline
      \endhead

      %% setup continuation note row
      \multicolumn{16}{l}{Continued on next page.} \\ \hline \hline
      \endfoot
      
      %% finish table with a couple of horizontal lines
      \hline
      \endlastfoot
}

\newcommand*{\shellMgmtFillLineA}[9]{ #1 & #2 & #3 & #4 & #5 & #6 & #7 & #8 & \parbox[b]{3cm}{\sloppy \small #9} & }
\newcommand*{\shellMgmtFillLineB}[7]{ #1 & #2 & #3 & #4 & #5 & #6 & #7}

\newcommand*{\shellMgmtEnd}{
    \end{longtable}
  \end{center}
  \pagebreak[1]                 %just a suggestion...
}

\newcommand*{\dryerEffTblStart}{
  \begin{center}
    \begin{longtable}{|r|c|c|c|c|}
      %% setup dateline for top of table's first page
      Bin&Total hrs& Full hrs & Empty hrs & full \% \\ \hline \hline
      \endfirsthead

      %% setup dateline for top of subsequent pages
      \multicolumn{5}{l}{-- continued from previous page.} \\ \hline
      Bin&Total hrs& Full hrs & Empty hrs & full \% \\ \hline
      \endhead

      %% setup continuation note row
      \multicolumn{5}{l}{Continued on next page.} \\ \hline \hline
      \endfoot
      
      %% finish table with a couple of horizontal lines
      \hline
      \endlastfoot
}

\newcommand*{\dryerEffTblRow}[5]{
  #1 & #2 & #3 & #4 & #5 \\
}  

\newcommand*{\dryerEffTblEnd}{
    \end{longtable}
  \end{center}
  \pagebreak[1]                 %just a suggestion...
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%% Fill report, full (one per page) commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand*{\fullFillRptNewPage}[1]{
  \Large{#1} \newline
}
